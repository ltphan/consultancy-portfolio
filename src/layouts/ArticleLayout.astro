---
import Layout from "./Layout.astro";

interface Props {
  title: string;
  subtitle: string;
  date: string;
  publishedAt: Date;
  author: string;
  authorBio: string;
  authorImage: string;
  description: string;
  image?: string;
  imageAlt?: string;
  tags: string[];
  readTime?: string;
  keywords?: string[];
  slug: string;
}

const {
  title,
  subtitle,
  date,
  publishedAt,
  author,
  authorBio,
  authorImage,
  description,
  image,
  imageAlt,
  tags,
  readTime,
  keywords,
  slug,
} = Astro.props;

const pageTitle = `${title} | Linh Phan`;
const canonicalURL = new URL(`/articles/${slug}`, Astro.site);
const ogImage = image || "/lp-logo-og.png";

// Schema.org structured data
const structuredData = {
  "@context": "https://schema.org",
  "@type": "Article",
  headline: title,
  description: description,
  image: image
    ? new URL(image, Astro.site).href
    : new URL("/lp-logo-og.png", Astro.site).href,
  author: {
    "@type": "Person",
    name: author,
    description: authorBio,
    image: new URL(authorImage, Astro.site).href,
  },
  publisher: {
    "@type": "Person",
    name: "Linh Phan",
    description:
      "Product Designer & Developer specializing in AI-powered solutions",
  },
  datePublished: publishedAt.toISOString(),
  dateModified: publishedAt.toISOString(),
  keywords: keywords?.join(", ") || tags?.join(", ") || "",
  articleSection: "Technology",
  wordCount: "1000", // You could calculate this dynamically
  url: canonicalURL.href,
};
---

<Layout title={pageTitle}>
  <!-- Schema.org structured data -->
  <script
    type="application/ld+json"
    set:html={JSON.stringify(structuredData)}
  />

  <!-- Meta tags -->
  <meta slot="head" name="description" content={description} />
  <meta
    slot="head"
    name="keywords"
    content={keywords?.join(", ") || tags?.join(", ") || ""}
  />
  <meta slot="head" name="author" content={author} />
  <link slot="head" rel="canonical" href={canonicalURL.href} />

  <!-- Open Graph -->
  <meta slot="head" property="og:type" content="article" />
  <meta slot="head" property="og:title" content={title} />
  <meta slot="head" property="og:description" content={description} />
  <meta slot="head" property="og:url" content={canonicalURL.href} />
  <meta slot="head" property="og:image" content={ogImage} />
  <meta slot="head" property="article:author" content={author} />
  <meta
    slot="head"
    property="article:published_time"
    content={publishedAt.toISOString()}
  />
  <meta slot="head" property="article:section" content="Technology" />
  {
    tags?.map((tag) => (
      <meta slot="head" property="article:tag" content={tag} />
    ))
  }

  <!-- Twitter Card -->
  <meta slot="head" name="twitter:card" content="summary_large_image" />
  <meta slot="head" name="twitter:title" content={title} />
  <meta slot="head" name="twitter:description" content={description} />
  <meta slot="head" name="twitter:image" content={ogImage} />

  <main
    class="min-h-screen bg-white"
    itemscope
    itemtype="https://schema.org/Article"
  >
    <!-- Simple Navigation -->
    <nav
      class="fixed top-10 left-10 right-10 z-10 flex justify-between items-center max-w-3xl mx-auto"
    >
      <a
        href="/Portfolio_Minimalist#writing"
        class="text-sm text-gray-600 hover:text-black transition-colors"
      >
        ← Back
      </a>
      <a
        href="/"
        class="hover:opacity-80 transition-opacity"
        title="Go to home"
      >
        <img
          src="/src/assets/logo-only.png"
          alt="Linh Phan"
          class="h-8 w-auto"
        />
      </a>
    </nav>

    <!-- Article Container -->
    <article
      class="pt-32 pb-24"
      itemscope
      itemtype="https://schema.org/Article"
    >
      <!-- Article Header -->
      <header class="max-w-3xl mx-auto px-6 mb-16">
        <!-- Just the date -->
        <div class="text-sm text-gray-500 mb-6">
          <time datetime={publishedAt.toISOString()} itemprop="datePublished"
            >{date}</time
          >
        </div>

        <h1
          class="text-5xl md:text-6xl font-light leading-tight tracking-tight mb-6"
          itemprop="headline"
        >
          {title}
        </h1>

        <p class="text-xl text-gray-600 leading-relaxed" itemprop="description">
          {subtitle}
        </p>
      </header>

      <!-- Article Content -->
      <div
        class="article-content max-w-3xl mx-auto px-6"
        itemprop="articleBody"
      >
        <slot />

        <!-- Call to Action -->
        <div class="mt-16 pt-12 border-t border-gray-200">
          <p class="text-gray-600 mb-6">
            Ready to collaborate on your next project?
          </p>
          <button
            onclick="window.location.href='/#contact'"
            class="bg-black text-white px-8 py-4 rounded-xl hover:opacity-80 transition-opacity"
          >
            Get in touch
          </button>
        </div>
      </div>
    </article>

    <!-- Article Footer -->
    <footer class="border-t border-gray-200">
      <div class="max-w-3xl mx-auto px-6 py-12">
        <div class="flex justify-between items-center">
          <a
            href="/"
            class="text-sm text-gray-600 hover:text-black transition-colors"
          >
            ← Back to home
          </a>
        </div>
      </div>
    </footer>
  </main>
</Layout>

<style>
  /* Article-specific typography */
  .article-content {
    font-family:
      "Inter",
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      sans-serif;
  }

  /* Code styling */
  code {
    font-family: "SF Mono", "Monaco", "Inconsolata", "Fira Code", monospace;
  }

  /* Image styling */
  figure img {
    width: 100%;
    height: auto;
    display: block;
  }

  /* Link styling in articles */
  .article-content a {
    color: #000;
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: opacity 0.2s;
  }

  .article-content a:hover {
    opacity: 0.6;
  }

  /* Responsive images */
  @media (max-width: 768px) {
    h1 {
      font-size: 36px;
    }

    .grid {
      grid-template-columns: 1fr;
    }
  }
</style>
